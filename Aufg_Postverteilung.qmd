# Postverteilung 

*Übungsaufgaben zum Ziehen und Verwenden von Stichproben*

```{r}
#| include: false

library(tidyverse)
library(rstanarm)
library(easystats)
```

Als Grundlage für die folgenden Aufgaben dient der Globusversuch aus Kapitel 6. Gegeben sei folgende Postverteilung:

```{r}
d <-
  tibble(gitter = seq(0, 1, by = .1),
         prior = 1)%>%
  mutate(likelihood = dbinom(14, 20, prob = gitter),
         unst_post = prior * likelihood,
         post = unst_post / sum(unst_post))
```

```{r}
Stichprobe <-
  d%>%
  slice_sample(n = 1e4,
               weight_by = post,
               replace = TRUE)
Stichprobe
```

## Aufgabe 1

::: panel-tabset
### A1

Ziehen Sie eine Stichprobe mit einer Größe von 10.000 Fällen. Grundlage ist der Globusversuch mit 14 von 20 Wassertreffern. Nehmen Sie an, dass Sie für 10 Hypothesen apriori indifferent sind.

### L1

```{r}
sample1 <-
  tibble(gitter = seq(0, 1, length.out = 10), #Gitter erstellen
         prior = 1)%>%
  mutate(likelihood = dbinom(14, size = 20, prob = gitter),
         unst_post = prior * likelihood,
         post = unst_post / sum(unst_post))%>%
  slice_sample(n = 1e4, #Stichprobe ziehen
               weight_by = post,
               replace = TRUE)
```
:::

## Aufgabe 2

::: panel-tabset
### A2

Wie groß ist die Wahrscheinlichkeit, dass der Wasseranteil größer als 50 Prozent ist?

### L2

```{r}
sample1%>%
  count(gitter > .5)%>%
  mutate(Anteil = n/10000)
```

Die Wahrscheilichkeit, dass der Wasseranteil größer als 50 Prozent ist, liegt bei \~ 96 Prozent.
:::

## Aufgabe 3

::: panel-tabset
### A3

Wie groß ist die Wahrscheinlichkeit, dass der Wasseranteil zwischen 65 und 75 Prozent liegt?

### L3

```{r}
sample1%>%
  filter(gitter > .65)%>%
  filter(gitter < .75)%>%
  count()%>%
  summarise(`Anteil in Prozent` = n / 10000 * 100)
```

Die Wahrscheinlichkeit, dass der Wasseranteil zwischen 65 und 75 Prozent ist, liegt bei \~ 42 Prozent.
:::

## Aufgabe 4

::: panel-tabset
### A4

Welcher ist der mittlere Wasseranteil und wie groß ist die Standardabweichung der Verteilung?

### L4

```{r}
sample1%>%
  summarise(`Mittlerer Wasseranteil` = mean(gitter),
            `Standardabweichung der möglichen Wasseranteile` = sd(gitter))
```
:::

## Aufgabe 5

::: panel-tabset
### A5

Welcher Wasseranteil wird mit einer Wahrscheinlichkeit von 70 Prozent nicht überschritten?

### L5

```{r}
sample1%>%
  summarise(quant70 = quantile(gitter, prob = .7))
```

Mit einer Wahrscheinlichkeit von 70 Prozent wird ein Wasseranteil von 77 Prozent nicht überschritten.
:::

## Aufgabe 6

::: panel-tabset

### A6

Beantworten Sie Aufgabe 5 ein weiteres Mal, ohne dabei die Funktion `quantile()` zu verwenden.

### L6
```{r}
sample1%>%
  arrange(gitter)%>%
  slice_head(n = 7000)%>%
  arrange(-gitter)
```

Wir sehen, der größte Wert der Spalte gitter, nachdem wir 7000 Werte abgeschnitten haben, ist 0.78. Das heißt ein Wasseranteil von 0.7 muss größer sein als 70 % Prozent der insgesamt 10.000 Werte.
:::

## Aufgabe 7

::: panel-tabset

### A7
Bilden Sie ein symmetrisches Perzentilinterval, das zeigt, zwischen welchen beiden Parameterwerten sich 90 Prozent der Verteilung befinden.

### L7
```{r}
sample1%>%
  select(gitter)%>%
  eti(ci = .9)
```

90 % aller Zeilen haben einen Wasseranteil von 56 bis 78 Prozent.
:::

## Aufgabe 8

::: panel-tabset

### A8
Geben Sie die Breite des Intervalls mit der höchsten Wahrscheinlichkeitsdichte, das 95 % aller Werte beinhaltet, an.

### L8
```{r}
sample1%>%
  select(gitter)%>%
  hdi()
```
```{r}
0.56 - 0.89
```
Die Breite des HDI ist 33. \
Hier noch eine andere Variante, die das Ergebnis direkt ausspuckt:

```{r}
sample1%>%
  select(gitter)%>%
  hdi() %>% 
  mutate(width = CI_low - CI_high) %>%
  select(width)
```
:::